# File: devops_tools/argocd-apps/home/deployment.yaml
# K8s Lab welcome page â€” served at /
apiVersion: v1
kind: ConfigMap
metadata:
  name: home-page
  namespace: home
data:
  index.html: |
    <!DOCTYPE html>
    <html lang="en">
    <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>K8s Lab â€” Karamjit Brar</title>
      <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:'Segoe UI',system-ui,-apple-system,sans-serif;background:#0f172a;color:#e2e8f0;min-height:100vh;display:flex;align-items:center;justify-content:center}
        .container{max-width:720px;width:90%;text-align:center;padding:3rem 2rem}
        h1{font-size:2.4rem;font-weight:700;margin-bottom:.5rem;background:linear-gradient(135deg,#38bdf8,#818cf8);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
        .subtitle{color:#94a3b8;font-size:1.1rem;margin-bottom:2.5rem}
        .card{background:#1e293b;border:1px solid #334155;border-radius:12px;padding:1.8rem;margin-bottom:1.5rem;text-align:left}
        .card h2{font-size:1.1rem;color:#38bdf8;margin-bottom:1rem;display:flex;align-items:center;gap:.5rem}
        .card h2::before{content:'âŽˆ';font-size:1.3rem}
        .info-grid{display:grid;grid-template-columns:1fr 1fr;gap:.6rem .8rem}
        .info-item{display:flex;flex-direction:column}
        .info-label{font-size:.75rem;text-transform:uppercase;letter-spacing:.05em;color:#64748b}
        .info-value{font-size:.95rem;color:#cbd5e1}
        .apps{margin-top:1.5rem}
        .apps h2::before{content:'ðŸ“¦'}
        .app-list{list-style:none;display:flex;flex-wrap:wrap;gap:.6rem}
        .app-list a{display:inline-block;padding:.45rem 1rem;background:#334155;border-radius:8px;color:#e2e8f0;text-decoration:none;font-size:.9rem;transition:background .2s}
        .app-list a:hover{background:#475569}
        .app-group{margin-top:.9rem;padding:1rem;border:1px dashed #334155;border-radius:12px;background:#111827}
        .app-group:first-of-type{margin-top:0}
        .section-title{font-size:.85rem;letter-spacing:.08em;text-transform:uppercase;color:#94a3b8;margin-bottom:.6rem;display:flex;align-items:center;gap:.5rem}
        .section-title .icon{font-size:1rem}
        .list{list-style:none;display:grid;gap:.6rem}
        .list li{background:#0f172a;border:1px solid #1f2937;border-radius:10px;padding:.75rem .9rem;color:#cbd5e1}
        .list strong{color:#e2e8f0}
        .meta{margin-top:1rem;font-size:.85rem;color:#64748b}
        .pill{display:inline-block;padding:.2rem .6rem;border-radius:999px;background:#0b3a56;color:#7dd3fc;font-size:.75rem;border:1px solid #0f4c6a}
        .pills{display:flex;flex-wrap:wrap;gap:.4rem}
        .footer{margin-top:2.5rem;color:#475569;font-size:.8rem}
        .footer a{color:#64748b;text-decoration:none}
        .footer a:hover{color:#94a3b8}
        @media(max-width:480px){h1{font-size:1.8rem}.info-grid{grid-template-columns:1fr}}
      </style>
    </head>
    <body>
      <div class="container">
        <h1>Welcome to the K8s Lab</h1>
        <p class="subtitle">A personal Kubernetes playground by Karamjit Brar</p>

        <div class="card">
          <h2>Cluster Overview</h2>
          <div class="info-grid">
            <div class="info-item">
              <span class="info-label">Platform</span>
              <span class="info-value">Oracle Cloud (OCI) â€” ARM</span>
            </div>
            <div class="info-item">
              <span class="info-label">Architecture</span>
              <span class="info-value">aarch64 (arm64)</span>
            </div>
            <div class="info-item">
              <span class="info-label">Host OS</span>
              <span class="info-value">Oracle Linux 9.6</span>
            </div>
            <div class="info-item">
              <span class="info-label">Kernel</span>
              <span class="info-value">6.12.0 UEK</span>
            </div>
            <div class="info-item">
              <span class="info-label">Ingress</span>
              <span class="info-value">NGINX Ingress Controller</span>
            </div>
            <div class="info-item">
              <span class="info-label">Service Mesh</span>
              <span class="info-value">Istio + Kiali</span>
            </div>
            <div class="info-item">
              <span class="info-label">GitOps</span>
              <span class="info-value">ArgoCD + ApplicationSets</span>
            </div>
            <div class="info-item">
              <span class="info-label">CI / CD</span>
              <span class="info-value">GitHub Actions â†’ GHCR</span>
            </div>
            <div class="info-item">
              <span class="info-label">TLS</span>
              <span class="info-value">Let's Encrypt / cert-manager</span>
            </div>
            <div class="info-item">
              <span class="info-label">Observability</span>
              <span class="info-value">Prometheus + Grafana</span>
            </div>
          </div>
        </div>

        <div class="card">
          <h2>How This Lab Works</h2>
          <ul class="list">
            <li><strong>Git as source of truth.</strong> Manifests live in Git and are applied via ArgoCD.</li>
            <li><strong>Declarative deployments.</strong> Services are synced with ArgoCD ApplicationSets.</li>
            <li><strong>Secure by default.</strong> HTTPS enforced at the ingress with cert-manager.</li>
            <li><strong>Observability baked in.</strong> Metrics flow to Prometheus and dashboards in Grafana.</li>
          </ul>
          <div class="meta">Want details? See the repo and manifests linked below.</div>
        </div>

        <div class="card apps">
          <h2>Deployed Apps</h2>
          <div class="app-group">
            <div class="section-title"><span class="icon">ðŸŽ¯</span>Product Apps</div>
            <ul class="app-list">
              <li><a href="https://momo.karamjitbrar.com">Moment in Motion</a></li>
            </ul>
          </div>

          <div class="app-group">
            <div class="section-title"><span class="icon">ðŸ§°</span>Cluster Tools</div>
            <ul class="app-list">
              <li><a href="https://argocd.karamjitbrar.com">ArgoCD</a></li>
              <li><a href="https://grafana.karamjitbrar.com">Grafana</a></li>
              <li><a href="https://kiali.karamjitbrar.com">Kiali</a></li>
              <li><a href="https://headlamp.karamjitbrar.com">Headlamp</a></li>
            </ul>
          </div>
          <div class="meta">
            <div class="pills">
              <span class="pill">GitOps</span>
              <span class="pill">Service Mesh</span>
              <span class="pill">Observability</span>
              <span class="pill">Ingress + TLS</span>
            </div>
          </div>
        </div>

        <p class="footer">
          <a href="https://github.com/brar-karamjit" target="_blank" rel="noopener">GitHub</a>
          &nbsp;Â·&nbsp;
          <a href="https://karamjitbrar.com" target="_blank" rel="noopener">Portfolio</a>
          &nbsp;Â·&nbsp;
          <a href="https://github.com/brar-karamjit/devops_tools" target="_blank" rel="noopener">Infra Repo</a>
        </p>
      </div>
    </body>
    </html>
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: home-deployment
  namespace: home
  labels:
    app: home
spec:
  replicas: 1
  selector:
    matchLabels:
      app: home
  template:
    metadata:
      labels:
        app: home
    spec:
      containers:
      - name: nginx
        image: nginx:alpine
        ports:
        - containerPort: 80
        volumeMounts:
        - name: html
          mountPath: /usr/share/nginx/html
          readOnly: true
      volumes:
      - name: html
        configMap:
          name: home-page
---
apiVersion: v1
kind: Service
metadata:
  name: home-service
  namespace: home
spec:
  selector:
    app: home
  ports:
  - protocol: TCP
    port: 80
    targetPort: 80
  type: ClusterIP
---
apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: home-ingress
  namespace: home
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt-prod
    nginx.ingress.kubernetes.io/force-ssl-redirect: "true"
spec:
  ingressClassName: nginx
  rules:
  - host: k8s.karamjitbrar.com
    http:
      paths:
      - path: /
        pathType: Prefix
        backend:
          service:
            name: home-service
            port:
              number: 80
  tls:
  - secretName: k8s-tls
    hosts:
    - k8s.karamjitbrar.com